<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="661px" height="437px" viewBox="-0.5 -0.5 661 437" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2020-08-24T03:30:40.278Z&quot; agent=&quot;5.0 (X11; Fedora; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Safari/537.36&quot; etag=&quot;5XT20bWh0C25prJn0a_x&quot; version=&quot;13.6.4&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;kgpKYQtTHZ0yAKxKKP6v&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g><path d="M 425 392 L 263.12 392" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 256.12 392 L 263.12 388.5 L 263.12 395.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px"><rect fill="#ffffff" stroke="none" x="317" y="377" width="47" height="14" stroke-width="0"/><text x="339.36" y="386.5">Reveal K</text></g><rect x="20" y="56" width="100" height="40" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 70 96 L 70 436" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="69.5" y="80.5">User</text></g><rect x="65" y="126" width="10" height="243" fill="#ffffff" stroke="#000000" pointer-events="all"/><rect x="200" y="56" width="100" height="40" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 250 96 L 250 436" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="249.5" y="80.5">Smart contract</text></g><rect x="245" y="136" width="10" height="20" fill="#ffffff" stroke="#000000" pointer-events="all"/><rect x="245" y="392" width="10" height="24" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 75 136 L 236.88 136" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 243.88 136 L 236.88 139.5 L 236.88 132.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px"><rect fill="#ffffff" stroke="none" x="111" y="108" width="99" height="27" stroke-width="0"/><text x="159.64" y="117.5">Get available nodes</text><text x="159.64" y="130.5"> and their fees</text></g><path d="M 249 156 L 78.05 156" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 71.05 156 L 78.05 152.5 L 78.05 159.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="380" y="55.5" width="100" height="40" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 430 95.5 L 430 436" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="429.5" y="80">Node</text></g><rect x="425" y="270.5" width="10" height="145" fill="#ffffff" stroke="#000000" pointer-events="all"/><rect x="0" y="6" width="660" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 658px; height: 1px; padding-top: 16px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 28px">tBTC -&gt; </font><span style="font-size: 28px">Lightning network</span></div></div></div></foreignObject><text x="330" y="20" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">tBTC -&gt; Lightning network</text></switch></g><path d="M 252 270 L 416.88 270.48" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 423.88 270.5 L 416.87 273.98 L 416.89 266.98 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 425 325.47 L 83.12 326.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 76.12 326.52 L 83.11 323 L 83.13 330 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px"><rect fill="#ffffff" stroke="none" x="145" y="310" width="211" height="14" stroke-width="0"/><text x="249.64" y="320.49">Check that invoice uses hash(K) and pay it</text></g><path d="M 75 171 L 95 171.03 L 95 191.03 L 83.12 191.01" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 76.12 191 L 83.12 187.51 L 83.11 194.51 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 181px; margin-left: 99px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; "> Extract hash(K)<br />  from LN invoice</div></div></div></foreignObject><text x="99" y="185" fill="#000000" font-family="Helvetica" font-size="11px">Extract hash(K)...</text></switch></g><path d="M 75 251 L 236.88 251" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 243.88 251 L 236.88 254.5 L 236.88 247.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px"><rect fill="#ffffff" stroke="none" x="102" y="210" width="117" height="40" stroke-width="0"/><text x="159.64" y="219.5">Lock tBTC</text><text x="159.64" y="232.5">(spendable by Node</text><text x="159.64" y="245.5">if K is revealed on time)</text></g><rect x="245" y="251" width="10" height="20" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 74.81 299.96 L 416.88 299.96" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 423.88 299.96 L 416.88 303.46 L 416.88 296.46 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px"><rect fill="#ffffff" stroke="none" x="135" y="284" width="231" height="14" stroke-width="0"/><text x="249.17" y="294.46">Provide lightning invoice with hash(K) as HTLC</text></g><rect x="450" y="266" width="170" height="50" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 168px; height: 1px; padding-top: 291px; margin-left: 451px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">If this part takes over 1 hour (node is unresponsive) User can get their tBTC back</div></div></div></foreignObject><text x="535" y="295" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">If this part takes over 1 ho...</text></switch></g><path d="M 75 348 L 95 348 L 95 368 L 83.12 368" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 76.12 368 L 83.12 364.5 L 83.12 371.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 358px; margin-left: 99px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; "> Reveal K to<br /> claim invoice</div></div></div></foreignObject><text x="99" y="362" fill="#000000" font-family="Helvetica" font-size="11px">Reveal K to...</text></switch></g><path d="M 250 416 L 416.88 416" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 423.88 416 L 416.88 419.5 L 416.88 412.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px"><rect fill="#ffffff" stroke="none" x="302" y="401" width="71" height="14" stroke-width="0"/><text x="336.93" y="410.5">Transfer tBTC</text></g><path d="M 620 251 L 249 251" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><path d="M 620 326 L 424.23 325.75" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><path d="M 620 373 L 69.6 372.92" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><rect x="450" y="331" width="170" height="35" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 168px; height: 1px; padding-top: 349px; margin-left: 451px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">If User takes too long to reveal K, LN payment times out</div></div></div></foreignObject><text x="535" y="352" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">If User takes too long to re...</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>